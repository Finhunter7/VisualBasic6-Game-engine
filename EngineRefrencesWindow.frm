VERSION 5.00
Object = "{6B7E6392-850A-101B-AFC0-4210102A8DA7}#1.3#0"; "COMCTL32.OCX"
Begin VB.Form EngineRefrences 
   Caption         =   "References"
   ClientHeight    =   4560
   ClientLeft      =   165
   ClientTop       =   510
   ClientWidth     =   8085
   Icon            =   "EngineRefrencesWindow.frx":0000
   LinkTopic       =   "Form3"
   ScaleHeight     =   4560
   ScaleWidth      =   8085
   StartUpPosition =   2  'CenterScreen
   Begin ComctlLib.ListView ListView1 
      Height          =   4095
      Left            =   0
      TabIndex        =   0
      Top             =   0
      Width           =   6735
      _ExtentX        =   11880
      _ExtentY        =   7223
      Arrange         =   2
      LabelWrap       =   -1  'True
      HideSelection   =   -1  'True
      _Version        =   327682
      Icons           =   "TreeImageList1"
      SmallIcons      =   "TreeImageList1"
      ForeColor       =   -2147483640
      BackColor       =   -2147483643
      BorderStyle     =   1
      Appearance      =   1
      NumItems        =   0
   End
   Begin ComctlLib.ImageList TreeImageList1 
      Left            =   7560
      Top             =   0
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   16
      ImageHeight     =   16
      MaskColor       =   12632256
      _Version        =   327682
      BeginProperty Images {0713E8C2-850A-101B-AFC0-4210102A8DA7} 
         NumListImages   =   37
         BeginProperty ListImage1 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":0442
            Key             =   ""
         EndProperty
         BeginProperty ListImage2 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":075C
            Key             =   ""
         EndProperty
         BeginProperty ListImage3 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":0A76
            Key             =   ""
         EndProperty
         BeginProperty ListImage4 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":0D90
            Key             =   ""
         EndProperty
         BeginProperty ListImage5 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":10AA
            Key             =   ""
         EndProperty
         BeginProperty ListImage6 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":13C4
            Key             =   ""
         EndProperty
         BeginProperty ListImage7 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":16DE
            Key             =   ""
         EndProperty
         BeginProperty ListImage8 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":19F8
            Key             =   ""
         EndProperty
         BeginProperty ListImage9 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":1D12
            Key             =   ""
         EndProperty
         BeginProperty ListImage10 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":202C
            Key             =   ""
         EndProperty
         BeginProperty ListImage11 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":2346
            Key             =   ""
         EndProperty
         BeginProperty ListImage12 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":2660
            Key             =   ""
         EndProperty
         BeginProperty ListImage13 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":297A
            Key             =   ""
         EndProperty
         BeginProperty ListImage14 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":2C94
            Key             =   ""
         EndProperty
         BeginProperty ListImage15 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":2FAE
            Key             =   ""
         EndProperty
         BeginProperty ListImage16 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":32C8
            Key             =   ""
         EndProperty
         BeginProperty ListImage17 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":35E2
            Key             =   ""
         EndProperty
         BeginProperty ListImage18 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":38FC
            Key             =   ""
         EndProperty
         BeginProperty ListImage19 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":3C16
            Key             =   ""
         EndProperty
         BeginProperty ListImage20 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":3F30
            Key             =   ""
         EndProperty
         BeginProperty ListImage21 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":424A
            Key             =   ""
         EndProperty
         BeginProperty ListImage22 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":4564
            Key             =   ""
         EndProperty
         BeginProperty ListImage23 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":487E
            Key             =   ""
         EndProperty
         BeginProperty ListImage24 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":4B98
            Key             =   ""
         EndProperty
         BeginProperty ListImage25 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":4EB2
            Key             =   ""
         EndProperty
         BeginProperty ListImage26 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":4FC4
            Key             =   ""
         EndProperty
         BeginProperty ListImage27 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":50D6
            Key             =   ""
         EndProperty
         BeginProperty ListImage28 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":51E8
            Key             =   ""
         EndProperty
         BeginProperty ListImage29 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":52FA
            Key             =   ""
         EndProperty
         BeginProperty ListImage30 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":540C
            Key             =   ""
         EndProperty
         BeginProperty ListImage31 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":5726
            Key             =   ""
         EndProperty
         BeginProperty ListImage32 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":5A40
            Key             =   ""
         EndProperty
         BeginProperty ListImage33 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":5D5A
            Key             =   ""
         EndProperty
         BeginProperty ListImage34 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":6074
            Key             =   ""
         EndProperty
         BeginProperty ListImage35 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":638E
            Key             =   ""
         EndProperty
         BeginProperty ListImage36 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":66A8
            Key             =   ""
         EndProperty
         BeginProperty ListImage37 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "EngineRefrencesWindow.frx":69C2
            Key             =   ""
         EndProperty
      EndProperty
   End
   Begin VB.Menu mnufile1 
      Caption         =   "File"
      Begin VB.Menu mnuNew1 
         Caption         =   "New"
         Begin VB.Menu mnuReference1 
            Caption         =   "Reference..."
         End
         Begin VB.Menu mnuReferenceFromFile1 
            Caption         =   "Reference From File..."
         End
      End
      Begin VB.Menu mnuSpace1 
         Caption         =   "-"
      End
      Begin VB.Menu mnuClose1 
         Caption         =   "Close"
      End
   End
   Begin VB.Menu mnuEdit1 
      Caption         =   "Edit"
   End
   Begin VB.Menu mnuView1 
      Caption         =   "View"
      Begin VB.Menu mnuPropertites1 
         Caption         =   "Propertites..."
      End
   End
   Begin VB.Menu mnuHelp1 
      Caption         =   "Help"
   End
End
Attribute VB_Name = "EngineRefrences"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Private GameEngine As EngineClass
Private Sub Command1_Click()
    
End Sub

Private Sub Command2_Click()
    
End Sub

Private Sub GetObjectReference()
    Dim newRefrence As EngineRefrence_Class
    
    Set newRefrence = ReferenceEditor.GetReferenceFromFile(GameEngine, Me)
    If newRefrence Is Nothing Then
        Exit Sub
    End If
    On Error Resume Next
    Set newRefrence.Refrence = GetObject(newRefrence.Path, newRefrence.RefrenceClass)
    If newRefrence.Refrence Is Nothing Then
        MsgBox "Failed To Add Reference To Object " & newRefrence.RefrenceClass, vbExclamation
        Exit Sub
    End If
    
    GameEngine.EngineRefrences.Add newRefrence, newRefrence.Name
    ListRefrences
End Sub

Private Sub CreateObjectReference()
    Dim newRefrence As EngineRefrence_Class
    
    Set newRefrence = ReferenceEditor.CreateNewReference(GameEngine, Me)
    If newRefrence Is Nothing Then
        Exit Sub
    End If
    On Error Resume Next
    Set newRefrence.Refrence = CreateObject(newRefrence.RefrenceClass, newRefrence.Server)
    If newRefrence.Refrence Is Nothing Then
        MsgBox "Failed To Add Reference To Object " & newRefrence.RefrenceClass, vbExclamation
        Exit Sub
    End If
    
    GameEngine.EngineRefrences.Add newRefrence, newRefrence.Name
    ListRefrences
End Sub

Public Sub RefrencesShow(ModalForm As Form, TGameEngine As EngineClass)
    Set GameEngine = TGameEngine
    ListRefrences
    Me.Show vbModal, ModalForm
End Sub

Private Sub ListRefrences()
    Dim curItem As Long
    Me.ListView1.ListItems.Clear
    For Each Item In GameEngine.EngineRefrences
        curItem = curItem + 1
        Me.ListView1.ListItems.Add , Item.Name, Item.Name, 12, 12
    Next
End Sub

Private Sub Command3_Click()

End Sub

Private Sub Form_Resize()
    On Error Resume Next
    Me.ListView1.Top = 0
    Me.ListView1.Left = 0
    Me.ListView1.Height = Me.Height - 800
    Me.ListView1.Width = Me.Width - 115
End Sub

Private Sub ListView1_DblClick()
    Dim curRef As Object
    If ListView1.selectedItem Is Nothing Then
        Exit Sub
    Else
        Set curRef = GameEngine.EngineRefrences.Item(ListView1.selectedItem.text)
        If curRef Is Nothing Then
            Exit Sub
        Else
            ReferenceEditor.ViewReference curRef, Me
        End If
    End If
End Sub

Private Sub mnuClose1_Click()
    Me.Hide
End Sub

Private Sub mnuReference1_Click()
    CreateObjectReference
End Sub

Private Sub mnuReferenceFromFile1_Click()
    GetObjectReference
End Sub
